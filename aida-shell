#!/usr/bin/env python3
import sys
import os

script_path = os.path.realpath(__file__)
script_dir = os.path.dirname(script_path)
ai_shell_path = os.path.join(script_dir, "ai_shell.py")

# Set up the environment
os.environ['PYTHONPATH'] = script_dir
os.environ['AI_CODER_PROJECT_ROOT'] = script_dir
sys.path.insert(0, script_dir)

# Change to the project directory temporarily to load config files
original_cwd = os.getcwd()
os.chdir(script_dir)

# Use the virtual environment's Python if it exists
venv_python = os.path.join(script_dir, ".venv", "bin", "python")
if os.path.exists(venv_python):
    python_executable = venv_python
else:
    python_executable = sys.executable

# Change back to original directory before executing
os.chdir(original_cwd)

# Execute the AI Shell
os.execv(python_executable, [python_executable, ai_shell_path] + sys.argv[1:])
